function commonGetTopLevelCategories(n){var t={countryId:1001,languageId:1001,packageCategoryId:n};return $.ajax({data:t,type:"post",url:"/Workspace/Content/Category"})}function commonGetSubCategories(n){var t={countryId:1001,languageId:1001,packageCategoryId:n};return $.ajax({data:t,type:"post",url:"/Workspace/Content/SubCategories"})}function commonGetStoryTypesByCategories(n){return $.ajax({data:n,type:"post",url:"/Workspace/Content/StoryTypesByCategories"})}function selectCheckBoxItems(n,t){$(t).each(function(t,i){$(n+"[value='"+i+"']").prop("checked",!0)})}function setRedactorEvents(n){var t=["formatting","bold","italic","unorderedlist","orderedlist","outdent","indent","link","alignment","video","textdirection","horizontalrule","textdirection","image","video"],u=["style","script"],s=!1,i=250,f=!0,r=["textdirection","video"],e=!0,o=!0;$(n).attr("data-height")!==undefined&&$(n).attr("data-height")!==""&&(i=parseInt($(n).attr("data-height")));$(n).attr("data-redactor-formatting")!==undefined&&$(n).attr("data-redactor-formatting")!==""&&($(n).attr("data-redactor-formatting").toLowerCase()==="title"?(t=["alignment"],i=0,r=!1):t=["formatting","bold","italic","unorderedlist","orderedlist","outdent","indent","link","alignment","horizontalrule"]);$(n).attr("data-redactor-openHTML")!==undefined&&$(n).attr("data-redactor-openHTML")!==""&&(t=["html"],u=["script"],s=!0,f=!1,r=!1,e=!1,o=!1);$(n).redactor({buttons:t,deniedTags:u,focus:!0,formattingAdd:[{"class":"primary",func:function(){var n=this;this.link.show();$("button.redactor-modal-btn.redactor-modal-action-btn").click(function(){n.link.addClass("btn btn-primary")})},title:"Button Link: Primary"},{"class":"outline",func:function(){var n=this;this.link.show();$("button.redactor-modal-btn.redactor-modal-action-btn").click(function(){n.link.addClass("btn btn-outline")})},title:"Button Link: Outline"},{"class":"green",func:function(){var n=this;this.link.show();$("button.redactor-modal-btn.redactor-modal-action-btn").click(function(){n.link.addClass("btn btn-green")})},title:"Button Link: Green"},{"class":"blue",func:function(){var n=this;this.link.show();$("button.redactor-modal-btn.redactor-modal-action-btn").click(function(){n.link.addClass("btn btn-blue")})},title:"Button Link: Blue"}],imageUpload:"/Workspace/Content/UploadContentImageForRedactor",minHeight:i,paragraphize:f,plugins:r,replaceDivs:e,visual:o,removeEmpty:["strong","em","span"]})}function getContentFeatured(n){var t=$('*[data-tilesname="'+n+'"]');getTiles($(t))}function preProcessFeaturedData(n){var t=n.Content.Identifier;TILES_CURRENT[t]=null}function initHeaderModuleTemplates(){$.get("/assets/templates/expertzone/HomeCarousel.html",{_:$.now()},function(n){CAROUSEL_TEMPLATE=n})}function initHeaderModuleEvents(){$(document).on("click",".btn-pillar-link",function(){var n=$(this).attr("href"),t;return n.charAt(0)==="#"?(t=$(String.format(".module[data-module-id={0}]",n.replace("#",""))),$("html, body").animate({scrollTop:$(t).offset().top},1e3),!1):$(this).prop("target").length===0&&n.indexOf("youtube")>-1?($("#youtubeModal").modal("show"),$("#youtubeModal button").prop("disabled",!1),$("#youtubeModal iframe").attr("src",n.replace("/watch?v=","/embed/")),!1):void 0});$("body").on("hidden.bs.modal","#youtubeModal",function(){var n=$(this);n.length>0&&stopVideo(n)});$(document).on("click",".js-header-video-modal-open",function(n){n.preventDefault();$("#headerVideoModal").modal("show");$("#headerVideoModal button").prop("disabled",!1)});$("body").on("hidden.bs.modal","#headerVideoModal",function(){var n=$(this);n.length>0&&stopVideo(n)})}function stopVideo(n){var t=n.find("iframe"),i=n.find("video"),r;t.length>0&&(r=t.attr("src"),t.attr("src",r));i.length>0&&i[0].pause()}function getProfile(){var n=30,t={navCategoryId:USERPACKAGECATEGORYID,storyTypes:"ProfileTile",skip:0*n,take:n,isBannered:!0,sortOrder:"Date",sortAscending:!1};$.ajax({url:"/Story/API",data:t,cache:!1,dataType:"json",success:function(n){var u,f;if(n.Error!==null)return bootbox.alert(n.Error),!1;var t=n.Data,i=[],r=[];$.each(t,function(n,t){$.inArray(t.TopLevelCategoryName,i)===-1&&i.push(t.TopLevelCategoryName);$.inArray(t.TopLevelCategory,r)===-1&&r.push(t.TopLevelCategory);t.Story!==undefined&&t.Story.Images!==undefined&&t.Story.Images.length>0&&$.each(t.Story.Images,function(n,i){i.Type===3?t.Story.BGImage=i.Url:i.Type===4&&(t.Story.MobileBGImage=i.Url)})});u=Mustache.to_html($(CAROUSEL_TEMPLATE).filter("#carouselSlideUserTpl").html(),{images:t});$("#slides-container").html(u);f=$(".slider").slick({slidesToShow:1,slidesToScroll:1,autoplay:!0,arrows:!1,asNavFor:".slide-menu",onBeforeChange:function(n,t){onSlideChange(n,t)}});$(".slide-menu .feature-banner-tab").on("click",function(){var n=$(this).data("menu-filter");$(".slider").slickFilter("."+removeSpaces(n));$(".slider").slickGoTo(1);$(".slide-menu .feature-banner-tab").removeClass("active-tab");$(this).addClass("active-tab")});$(".arrow-left").on("click",function(){$(".slider").slickPrev()});$(".arrow-right").on("click",function(){$(".slider").slickNext()});toggleCarouselSlides()}})}function getContentBannered(){var i=30,n,t,r;parseInt(USERPACKAGECATEGORYID)===7e3&&(USERPACKAGECATEGORYID="3200, 3300, 3600");n=[];t={};USERPACKAGECATEGORYID.length>0&&(t=makeIntArray(USERPACKAGECATEGORYID.split(",").clean("")),n=t.concat(n));r={NavCategories:n,Skip:0*i,Take:i};$.ajax({url:"/Story/API/Bannered",data:r,type:"POST",cache:!1,dataType:"json",success:function(n){var u,f;if(n.Error!==null)return bootbox.alert(n.Error),!1;var t=n.Data,i=[],r=[];$.each(t,function(n,t){$.inArray(t.TopLevelCategoryName,i)===-1&&i.push(t.TopLevelCategoryName);$.inArray(t.TopLevelCategory,r)===-1&&r.push(t.TopLevelCategory);t.Story!==undefined&&t.Story.Images!==undefined&&t.Story.Images.length>0&&$.each(t.Story.Images,function(n,i){i.Type===3?t.Story.BGImage=i.Url:i.Type===4&&(t.Story.MobileBGImage=i.Url)})});u=Mustache.to_html($(CAROUSEL_TEMPLATE).filter("#carouselSlideUserTpl").html(),{images:t});$("#slides-container").html(u);f=$(".slider").slick({slidesToShow:1,slidesToScroll:1,autoplay:!0,arrows:!1,asNavFor:".slide-menu",onBeforeChange:function(n,t){onSlideChange(n,t)}});$(".slide-menu .feature-banner-tab").on("click",function(){var n=$(this).data("menu-filter");$(".slider").slickFilter("."+removeSpaces(n));$(".slider").slickGoTo(1);$(".slide-menu .feature-banner-tab").removeClass("active-tab");$(this).addClass("active-tab")});$(".arrow-left").on("click",function(){$(".slider").slickPrev()});$(".arrow-right").on("click",function(){$(".slider").slickNext()});toggleCarouselSlides()}}).done(function(){})}function toggleCarouselSlides(){if($(".slider").length>0){var n=$("header").width();n<990&&$(".slider").slickUnfilter()}}function preProcessHeaderData(n,t){var r=getStoryImageByDescription(headerImageSizeDesktop),u=getStoryImageByDescription(bannerImageSizeDesktop),e=getStoryImageByDescription(headerImageSizeMobile),f,i;if(r.Url.indexOf("1200x186")>0&&!(u.Url.indexOf("1200x500")>0)&&(r=u),storyView&&(storyView.TopLevelCategoryName.length>0&&(n.Content.TopLevelCategoryName=storyView.TopLevelCategoryName,n.Content.TopLevelCategoryUrl=storyView.TopLevelCategoryUrl),storyView.CategoryName.length>0&&storyView.CategoryName!==storyView.TopLevelCategoryName&&(n.Content.CategoryName=storyView.CategoryName),n.Content.StoryType=storyView.Story.Type.toLowerCase()==="landingpage"?null:storyView.Type,n.Content.HeaderImageDesktop=r,n.Content.HeaderImageMobile=e,n.Content.StoryTitle=story.Title),(n.Content.Layout==="header-video-left"||n.Content.Layout==="header-video-right")&&t&&(n.Content.VideoUrl="",n.Content.IsEmbedded=!0,n.Content.PosterUrl=""),(n.Content.Layout==="header-pillar"||n.Content.Layout==="text-pillar")&&(f=3,t))for(n.Content.Pillars=[],i=0;i<f;i++)n.Content.Pillars.push({Id:guid(),PillarButtonDestinationUrl:"",PillarButtonText:"",PillarHtml:"",PillarImageUrl:defaultPillarUrl,PillarTitle:"",SortOrder:i});(n.Content.Layout==="header-pillar"||n.Content.Layout==="text-pillar")&&(t&&(n.Content.ActionButtonText="",n.Content.ActionButtonUrl=""),n.Content.PillarWrapperClass=String.format("col-sm-{0}",calcBootstrapColumnWidth(12,n.Content.Pillars.length)));n.Content.Layout==="header-profile-bannered"&&(n.Content.TopLevelCategoryId!==null?(USERPACKAGECATEGORYID=n.Content.TopLevelCategoryId,USERPACKAGESUBCATEGORYID=n.Content.SubCategoryId):(USERPACKAGECATEGORYID=$("#FirstTopLevelCategoryId").val(),USERPACKAGESUBCATEGORYID=$("#FirstSubCategoryId").val(),n.Content.TopLevelCategoryId=USERPACKAGECATEGORYID,n.Content.SubCategoryId=USERPACKAGESUBCATEGORYID));n.Content.Layout==="header-content-bannered"&&(t&&(USERPACKAGECATEGORYID=$("#FirstTopLevelCategoryId").val(),USERPACKAGESUBCATEGORYID=$("#FirstSubCategoryId").val()),n.Content.TopLevelCategoryId!==null&&(USERPACKAGECATEGORYID=n.Content.TopLevelCategoryId,USERPACKAGESUBCATEGORYID=n.Content.SubCategoryId))}function onSlideChange(){var n=!$(".slide-menu .active-tab").next().hasClass("slick-active"),t=!$(".slide-menu .active-tab").prev().hasClass("slick-active");n&&$(".slide-menu").slickNext();t&&$(".slide-menu").slickPrev()}function preProcessFilterData(n,t){t&&(CONTENTPACKAGECATEGORYID=$("#FirstTopLevelCategoryId").val(),CONTENTPACKAGESUBCATEGORYID=$("#FirstSubCategoryId").val());n.Content.Layout==="filter-default"&&n.Content.TopLevelCategoryId!==null&&(CONTENTPACKAGECATEGORYID=n.Content.TopLevelCategoryId,CONTENTPACKAGESUBCATEGORYID=n.Content.SubCategoryId);var i=n.Content.Identifier;TILES_CURRENT[i]=null}function preProcessAuthorData(n,t){var i;if(t)for(n.Content.Authors=[],i=0;i<1;i++)n.Content.Authors.push({Id:guid(),ProfilePicture:"/Assets/images/workspace/placeholder-camera-370x370.png",Name:"",Location:"",Bio:"",SortOrder:i});n.Content.AuthorTitle=storyLocalizations.SiteStrings.CoAuthor;n.Content.Authors&&n.Content.Authors.length>1&&(n.Content.AuthorTitle="Co-Author(s)")}function getContentRelated(n){var t=$('*[data-tilesname="'+n+'"]');getTiles($(t))}function preProcessRelatedData(n){var t=n.Content.Identifier;TILES_CURRENT[t]=null}function getRecommendedContent(n){var t=$('*[data-tilesname="'+n+'"]');getTiles($(t),!0,function(t){t!==undefined&&t.Data!=undefined&&t.Data.length>=3&&!$("#Story").hasClass("workspace")&&getStickyRecommendedTiles(t,n)})}function preProcessRecommendedData(n){var t=n.Content.Identifier;TILES_CURRENT[t]=null}function getStickyRecommendedTiles(n,t){var r=$('*[data-module-id="'+t+'"]'),i;n.Text=storyLocalizations.recommended;i=Mustache.render(getModuleDisplayTemplate("recommended","recommended-sticky"),n);$(r).append(i);$(".recommended-aside").addClass("sticky");$(document).on("click",".recommended-expand",function(n){n.stopPropagation();n.preventDefault();$(this).attr("data-expanded")==="true"?($(this).text("+"),$(this).attr("data-expanded",!1),$(".list-recommendedbuttons").removeClass("expanded-recommendedbuttons").addClass("compact-recommendedbuttons"),$(".list-recommendedbuttons").height("auto"),$(".btn-recommendedbuttons").addClass("hidden")):($(this).text("-"),$(this).attr("data-expanded",!0),$(".list-recommendedbuttons").removeClass("compact-recommendedbuttons").addClass("expanded-recommendedbuttons"),calculateExpandedRecommendedButtons())});$(window).on("resize",function(){$(".recommended-expand").attr("data-expanded")==="true"&&calculateExpandedRecommendedButtons()});$(document).on("click",".btn-recommendedbuttons",function(n){n.stopPropagation();n.preventDefault();$(this).attr("data-direction")==="up"?$(".list-recommendedbuttons li:last-child").prependTo($(".list-recommendedbuttons")):$(".list-recommendedbuttons li:first-child").appendTo($(".list-recommendedbuttons"))})}function calculateExpandedRecommendedButtons(){var t=$(".list-recommendedbuttons li").length,n=4,i=$(window).height()-($(".sticky-navbar").height()+100+($(".recommended-aside").height()-$(".list-recommendedbuttons").height()));i<$(".recommended-aside").height()&&(n=Math.round(i/$(".list-recommendedbuttons li").height()),n<1&&(n=1),n>4&&(n=4));n>t?n=t:t>n&&$(".btn-recommendedbuttons").removeClass("hidden");$(".list-recommendedbuttons").height(n*101)}function onStoryVideoStart(){}function onStoryVideoEnd(){}function onStoryVideoPlay(n){var t,i,r;$(n).parents(".video-wrapper").addClass("playing");currentPlayer!=""&&currentPlayer!=n.id&&(t=document.getElementById(currentPlayer),t!=null&&t.nodeName=="VIDEO"&&(t.pause(),i=t.src,r=t.currentTime,t.src="",t.load(),$(currentPlayer).remove(),t=document.getElementById(currentPlayer),t.src=i,t.currentTime=r));currentPlayer=n.id}function onStoryVideoPause(n){$(n).parents(".video-wrapper").removeClass("playing")}function initQuizModule(n){var t=getQuiz(n),i=getModule(n);(t.Progress===null||t.Progress===undefined)&&(t.Progress={});t.Progress.LastQuestionId="";t.Progress.Answers=[];t.Progress.NumberCorrect=0;t.Progress.Score=0;t.QuestionIndex=-1;initQuiz(t)}function initQuiz(n){var t=$(".module[data-module-id='"+n.Identifier+"']");$(t).find(".story-quiz .knowledgecheck").hide();$(t).find(".story-quiz .knowledgecheck .question").hide();$(t).find(".story-quiz .quiz-points").html(story.Points);$(t).find("#ConfirmationPassMessage").addClass("hidden");$(t).find("#ConfirmationFailMessage").addClass("hidden");n.QuizType==="Knowledge"?($(t).find("#btnBeginQuiz").text(storyLocalizations.knowledgecheck.BeginKnowledgeCheck),$(t).find("#headerQuizTitle").text(storyLocalizations.knowledgecheck.KnowledgeCheck)):($(t).find("#btnBeginQuiz").text(storyLocalizations.quiz.BeginQuiz),$(t).find("#headerQuizTitle").text(storyLocalizations.quiz.Quiz));$(t).find(".story-quiz .btn-startquiz").on("click",function(){n.QuestionIndex===-1&&(moveNextQuestion(n),$(t).find(".story-quiz .knowledgecheck").fadeIn(500),$(this).hide(),$(t).find(".list-story-quiz-overview").hide())});$(t).find(".question .list-knowledgecheck-multiple li.answer").on("click",function(){$(this).closest(".answered").length===0&&($(this).hasClass("selected")?($(this).closest(".question").attr("data-answer-id",""),$(this).removeClass("selected")):($(this).closest(".question").attr("data-answer-id",$(this).attr("data-id")),$(this).addClass("selected")))});$(t).find("#btnWrong").on("click",function(){$(t).find(".question .list-knowledgecheck-multiple").removeClass("answered");moveNextQuestion(n)});$(t).find("#btnCorrect").on("click",function(){moveNextQuestion(n)});$(t).find("#btnSubmit").off("click");$(t).find("#btnSubmit").on("click",function(){submitAnswer(n)});$(t).find("#btnTryAgain").hide();$(t).find("#btnTryAgain").on("click",function(){$(t).find(".question li.answer").removeClass("correct incorrect selected");$(t).find(".question .list-knowledgecheck-multiple").removeClass("answered");$(t).find(".story-quiz .knowledgecheck #btnSubmit").show();$(t).find(".story-quiz .knowledgecheck #btnTryAgain").hide()})}function submitAnswer(n){var t=$(".module[data-module-id='"+n.Identifier+"']");if($(t).find(".question[data-index="+n.QuestionIndex.toString()+"] .list-knowledgecheck-multiple .selected").length>0){$(t).find(".story-quiz .knowledgecheck #btnSubmit").hide();$(t).find(".question[data-index="+n.QuestionIndex.toString()+"] .list-knowledgecheck-multiple").addClass("answered");var i=$(t).find(".question[data-index="+n.QuestionIndex.toString()+"]").attr("data-id"),u=$(t).find(".question[data-index="+n.QuestionIndex.toString()+"]").attr("data-answer-id"),f=getQuestion(n,i),e=isCorrect(f),r={QuestionId:i,AnswerId:u,Correct:e};if(n.Progress.LastQuestionId=i,n.Progress.Answers.push(r),r.Correct)$(t).find(".story-quiz .knowledgecheck #btnCorrect").show(),$(t).find(".story-quiz .knowledgecheck #btnWrong").hide(),n.Progress.NumberCorrect++;else switch(n.QuizType){case"Educational":case"Knowledge":$(t).find(".story-quiz .knowledgecheck #btnCorrect").hide();$(t).find(".story-quiz .knowledgecheck #btnTryAgain").show();return;case"Traditional":default:$(t).find(".story-quiz .knowledgecheck #btnCorrect").hide();$(t).find(".story-quiz .knowledgecheck #btnWrong").show();n.Progress.Answers.push(r)}}else bootbox.alert("<p>"+storyLocalizations.quiz.SelectAnswer+"<\/p>")}function moveNextQuestion(n){var t=$(".module[data-module-id='"+n.Identifier+"']"),i,r;n.Questions.length===n.QuestionIndex+1?(n.Progress.Score=Math.round(n.Progress.NumberCorrect/n.Questions.length*100),n.QuizType==="Traditional"||n.QuizType==="Educational"?($(t).find(".progress-knowledgecheck .progress-bar").attr("aria-valuenow","100").css("width","100%"),$(t).find(".progress-knowledgecheck .progress-bar").html("Quiz Complete: "+n.Progress.Score.toString()+"%")):($(t).find(".progress-knowledgecheck .progress-bar").attr("aria-valuenow","100").css("width","100%"),$(t).find(".progress-knowledgecheck .progress-bar").html("Knowledge Check Complete")),$(t).find("#btnSubmit").hide(),$(t).find("#btnCorrect").hide(),$(t).find("#btnWrong").hide(),$(t).find(".question").hide(),n.PassingScore<=n.Progress.Score?$(t).find("#ConfirmationPassMessage").removeClass("hidden"):$(t).find("#ConfirmationFailMessage").removeClass("hidden"),i=getModule(n.Identifier),i.Progress.Score=n.Progress.Score,i.Progress.NumberCorrect=n.Progress.NumberCorrect,i.Progress.SuccessStatus=i.Progress.Score>=n.PassingScore?n.QuizType=="Knowledge"?"Completed":"Pass":"Fail",markQuizComplete(i)):(n.QuestionIndex>=0&&$(t).find(".story-quiz .knowledgecheck .question[data-index="+n.QuestionIndex.toString()+"]").hide(),n.QuestionIndex++,r=((n.QuestionIndex+1)/n.Questions.length*100).toString()+"%",$(t).find(".progress-knowledgecheck .progress-bar").attr("aria-valuenow",r).css("width",r),$(t).find(".progress-knowledgecheck .progress-bar").html(storyLocalizations.quiz.Question+" "+(n.QuestionIndex+1).toString()+"/"+n.Questions.length.toString()),$(t).find(".story-quiz .knowledgecheck .question[data-index="+n.QuestionIndex.toString()+"]").fadeIn(200),$(t).find(".story-quiz .knowledgecheck #btnCorrect").hide(),$(t).find(".story-quiz .knowledgecheck #btnWrong").hide(),$(t).find(".story-quiz .knowledgecheck #btnSubmit").show())}function isCorrect(n){for(var i,r=!0,t=0;t<n.Answers.length;t++)i=$(".question[data-id="+n.Id+"] .list-knowledgecheck-multiple li[data-id="+n.Answers[t].Id+"]"),i.length>0&&(!n.Answers[t].IsCorrect&&$(i).hasClass("selected")&&(r=!1),n.Answers[t].IsCorrect&&!$(i).hasClass("selected")&&(r=!1));return r}function getQuiz(n){var t=getModule(n);if(t!==null)return t.Content}function getQuestion(n,t){for(var i=0;i<n.Questions.length;i++)if(n.Questions[i].Id===t)return n.Questions[i]}function getAnswer(n,t){for(var i=0;i<n.Answers.length;i++)if(n.Answers[i].Id===t)return n.Answers[i]}function QuizObject(n){this.Identifier=n.Identifier;this.Submit=function(){return"submitted"}}function activateGallery(n){var t=$(String.format(".module[data-module-id={0}]",n));$(t).find(".image-gallery").length>0&&($(t).find(".image-gallery .carousel-inner div.item:first").addClass("active"),$(t).find(".image-gallery .carousel-indicators li:first").addClass("active"))}function galleryVisible(n){n.carousel("cycle")}function galleryNotVisible(n){n.carousel("pause")}function preProcessIntroductionData(n){var r,u,i,t;n.Content.LanguageName=story.LanguageName;n.Content.AllCategories=story.AllCategories;n.Content.MaximumRegistrations=storyLocalizations.skyperegistration.MaximumRegistrations;(n.Content.ActionButtonText==undefined||n.Content.ActionButtonText=="")&&(n.Content.ActionButtonText=storyLocalizations.skyperegistration.RegisterForLesson+" "+story.TypeTitle,n.Content.Function="register");r=[];u=[];for(i in story.AllCategories)switch(story.AllCategories[i].Title){case"Age Group":for(t=0;t<story.AllCategories[i].Children.length;t++)r.push(story.AllCategories[i].Children[t].Title);break;case"Subject":for(t=0;t<story.AllCategories[i].Children.length;t++)u.push(story.AllCategories[i].Children[t].Title)}n.Content.AgeGroups=r.join(", ");n.Content.Subjects=u.join(", ")}function getSchedule(){getScheduledTimes(story.Token)}function registerForSession(n,t){var i=$(".saveschedule,.btn-update-and-send, .btn-skip-and-send, .send-message").button("loading");$.ajax({data:t,type:"post",url:"/API/Interaction/"+n,success:function(i){if(i.Error!==null&&i.Error!==undefined&&i.Error!=="")return i.Error.toLowerCase().indexOf("unauthorized")>=0?showAuthModal():i.Error.toLowerCase().indexOf("3days")>=0?(message=storyLocalizations.SiteStrings.Request3Days,bootbox.confirm(message,function(i){i&&(t.overridecheck=!0,userHasAcknowledged3DayWindow=!0,registerForSession(n,t));$(".modal").on("hidden.bs.modal",function(){$(".modal").hasClass("in")&&$("body").addClass("modal-open")})})):(bootbox.alert(i.Error,function(){$(".modal").on("hidden.bs.modal",function(){$(".modal").hasClass("in")&&$("body").addClass("modal-open")})}),bindRegistered(i)),!1;$("#scheduleModal").html(i);$(".modal").animate({scrollTop:0},"slow")}}).done(function(){i.button("reset")})}function bindRegistered(n){var r=getModuleDisplayTemplate("affiliateduser","affiliateduser-single"),t=n.Data,u=Mustache.render(r,{Members:t}),i=$(".story-registered-row");i.length&&(i.html(u),i.ezRotateTile());$(".story-registered").find(".registered-member-length").html(t.length);$(".story-introduction-details").find(".registered-member-length").html(t.length)}function cancelSession(n){var t={token:story.Token,scheduledDate:n};$.ajax({data:t,type:"post",url:"/Story/Api/CancelSession",success:function(n){if(n.Error!==null)return n.Error.toLowerCase().indexOf("unauthorized")>=0?window.location.href="/Error/AccessDenied":bootbox.alert(n.Error),!1;bootbox.alert("You have been successfully un-registered from this interaction.")},error:function(n,t,i){bootbox.alert(i);hideLoader()},cache:!1})}function loadInterestedCount(){var n=String.format("/Story/Api/Interested?token={0}",story.Token);$.ajax({url:n,type:"post",success:function(n){n.Error!=null?bootbox.alert(n.Error,function(){$(".story-introduction-details").find(".interested-row").addClass("hidden")}):n.Data>0&&($(".story-introduction-details").find(".registered-member-length").html(n.Data),$(".story-introduction-details").find(".interested-row").removeClass("hidden"))},error:function(){},cache:!1})}function preProcessAffiliatedUserData(n){n.Content.Members=null;n.Content.IsRegisteredUsers=n.Content.IsRegisteredUsers==="true"||n.Content.IsRegisteredUsers===!0||n.Content.IsRegisteredUsers==="True"?!0:!1;n.Content.IsGuestSpeaker=n.Content.IsGuestSpeaker==="true"||n.Content.IsGuestSpeaker===!0||n.Content.IsGuestSpeaker==="True"?!0:!1;n.Content.IsPartner=n.Content.IsPartner==="true"||n.Content.IsPartner===!0||n.Content.IsPartner==="True"?!0:!1;n.Content.IsGuestSpeaker==="true"||n.Content.IsGuestSpeaker===!0||n.Content.IsGuestSpeaker==="True"?getAffiliatedUsers(n,"GuestSpeaker"):n.Content.IsPartner==="true"||n.Content.IsPartner===!0||n.Content.IsPartner==="True"?getAffiliatedUsers(n,"Partner"):(n.Content.IsRegisteredUsers==="true"||n.Content.IsRegisteredUsers===!0||n.Content.IsRegisteredUsers==="True")&&getAffiliatedUsers(n,"Registered")}function renderAffiliatedUsers(n,t,i){var u={Members:t.Data,Text:storyLocalizations[n.Content.Type.toLowerCase()]},f=$("div[data-module-id='"+n.Content.Identifier+"'] .tile-wrapper"),r,e,o;(r===null||r===undefined)&&(r=getModuleDisplayTemplate(n.Content.Type.toLowerCase(),"affiliateduser-single"),(r===null||r===undefined)&&(r=templates[n.Content.Type.toLowerCase()]));e=Mustache.render(r,u,null);f.length&&(f.html(e),o={formatType:"affiliateduser",perPage:3},f.ezRotateTile(o));$("div[data-module-id='"+n.Content.Identifier+"'] .member-length").text(u.Members.length);u.Members.length===0&&($("div[data-module-id='"+n.Content.Identifier+"']").hasClass("module-edit")||$("div[data-module-id='"+n.Content.Identifier+"']").addClass("hidden"));i==="Registered"&&$(".story-introduction-details").find(".registered-member-length").html(u.Members.length);initUserTileEvents();f.find(".btn.right.arrow").click(function(){initUserTileEvents()})}function getAffiliatedUsers(n,t){var i={token:story.Token,userType:t};$.ajax({data:i,type:"post",url:"/Story/Api/AffiliatedUsers",success:function(i){if(i.Error!==null&&i.Error!=="")return bootbox.alert(i.Error),!1;renderAffiliatedUsers(n,i,t)}})}function initSetFilterFromOpenHTML(){$(document).on("click",".openhtml-setfilter",function(){var t=$(this).attr("data-assocatedtiles"),i=$('.filter-bar[data-assocatedtiles="'+t+'"]'),r=$('.tile-wrapper[data-tilesname="'+t+'"]'),u=$(this).attr("data-type")+",",n=",",f;return $(this).attr("data-storytypeattribute")!==undefined&&(n=$(this).attr("data-storytypeattribute")+","),clearFilter(!1),r.attr("data-type",u),i.attr("data-type",u),n.replace(",","")!==""&&(r.attr("data-storytypeattribute",n),i.attr("data-storytypeattribute",n)),$(document).trigger("onFilterChange",{}),f=$(String.format(".module[data-module-id={0}]",t)),$("html, body").animate({scrollTop:$(f).offset().top-100},1e3),!1})}function initSkypeAThonOpenHTML(){function f(){$(t.get(n)).text(i[n]).addClass("animated fadeInDown");n++;n===t.length&&clearInterval(r)}var i,t,n=0,r,u={};$.ajax({url:"/Status/Connections/GetDistanceTraveled",type:"GET",dataType:"json",cache:!1,success:function(n){u=n.Data;i=("0000000000"+u.Miles).substr(-8)}});t=$("#miles-left .n");r=setInterval(f,200)}function preProcessSCORMData(n,t){this._version=n.Content.cmi__version;this._version=="3.4"&&(this.CurrentVersion="1.2");this._storyModuleId=n.Id;t}function RTE2004(){this.cmi__version=this._version;this.cmi_learner_id="";this.cmi_learner_name="";this.cmi_location="";this.cmi_credit="credit";this.cmi_completion_status="unknown";this.cmi_entry="";this.cmi_score__children="";this.cmi_score_raw="";this.cmi_score_min="";this.cmi_score_max="";this.cmi_total_time="";this.cmi_mode="normal";this.cmi_exit="";this.cmi_session_time="";this.cmi_suspend_data="";this.cmi_launch_data="";this.cmi_comments_from_learner="";this.cmi_comments_from_lms="";this.cmi_learner_preference__children="";this.cmi_learner_preference_audio="1";this.cmi_learner_preference_language="";this.cmi_learner_preference_speed="1";this.cmi_learner_preference_text="0";this.cmi_scaled_passing_score="0.8";this.cmi_max_time_allowed="";this.cmi_time_limit_action="continue,no message";this.cmi_success_status="unknown";this.cmi_completion_threshold="0.8";this.cmi_progress_measure="";this.cmi_interactions__children="id,type,objectives,timestamp,correct_responses,weighting,learner_response,result,latency,description";this.cmi_interactions=[]}function objectives(){this.id=""}function correct_responses(){this.pattern=[]}function interactions(){this.id="";this.type="";this.objectives=[];this.timestamp="";this.correct_responses=[];this.weighting="";this.learner_response="";this.result="";this.latency="";this.description=""}function Set12VariableTo2004(n){switch(n){case"cmi_core_session_time":n="cmi_session_time";break;case"cmi_core_student_name":n="cmi_learner_name";break;case"cmi_core_student_id":n="cmi_learner_id";break;case"cmi_core_lesson_status":n="cmi_completion_status";break;case"cmi_core_lesson_mode":n="cmi_mode";break;case"cmi_core_exit":n="cmi_exit";break;case"cmi_core_lesson_location":n="cmi_location";break;case"cmi_core_credit":n="cmi_credit";break;case"cmi_core_entry":n="cmi_entry";break;case"cmi_core_score_raw":n="cmi_score_raw";break;case"cmi_core_score_min":n="cmi_score_min";break;case"cmi_core_score_max":n="cmi_score_max";break;case"cmi_core_total_time":n="cmi_total_time";break;case"cmi_comments":n="cmi_comments_from_learner";break;case"cmi_student_preference_audio":n="cmi_learner_preference_audio";break;case"cmi_student_preference_language":n="cmi_learner_preference_language";break;case"cmi_student_preference_speed":n="cmi_learner_preference_speed";break;case"cmi_student_preference_text":n="cmi_learner_preference_text";break;case"cmi_student_data_max_time_allowed":n="cmi_max_time_allowed";break;case"cmi_student_data_mastery_score":n="cmi_scaled_passing_score"}return n}function Map12VariablesTo2004(n,t){t.cmi_score__children=n.cmi_core_score__children;t.cmi_learner_preference__children="";t.cmi_scaled_passing_score=n.cmi_student_data_mastery_score/100}function contains(n,t){for(var i=n.length;i--;)if(n[i]===t)return!0;return!1}function LMSInitialize(n){return Initialize(n)}function LMSGetValue(n){return GetValue(n)}function LMSSetValue(n,t){return SetValue(n,t)}function LMSGetLastError(){return GetLastError()}function LMSGetErrorString(n){return GetErrorString(n)}function LMSCommit(n){return Commit(n)}function LMSFinish(n){return Terminate(n)}function Initialize(n){return n!=""?SetError(201):_terminated?SetError(104):_initialized?SetError(103):(_initialized=!0,"true")}function GetValue(n){if(_errorCode=0,!_initialized)return SetErrorBlankResponse(122);if(_terminated)return SetErrorBlankResponse(123);n=n.replace(/\./g,"_");CurrentVersion=="1.2"&&(n=Set12VariableTo2004(n));switch(n){case"cmi_completion_status":if((RTE.cmi_completion_threshold!=null||RTE.cmi_completion_threshold!="")&&(RTE.cmi_progress_measure!=null||RTE.cmi_progress_measure!="")){if((RTE.cmi_progress_measure==null||RTE.cmi_progress_measure==""||RTE.cmi_progress_measure=="0"||RTE.cmi_progress_measure==0)&&(RTE.cmi_score_raw!=null||RTE.cmi_score_raw!="")&&(RTE.cmi_progress_measure=RTE.cmi_score_raw/100),RTE.cmi_completion_threshold>RTE.cmi_progress_measure)return"incomplete";if(RTE.cmi_completion_threshold<=RTE.cmi_progress_measure)return SetValue("cmi_completion_status","completed"),"completed"}break;case"cmi_interactions__count":return RTE.cmi_interactions.length}return RTE[n]}function SetValue(n,t){var i,r;if(_dirty=!0,n=n.replace(/\./g,"_"),CurrentVersion=="1.2"){n=Set12VariableTo2004(n);switch(n){case"cmi_exit":t=="logout"&&(t="normal");break;case"cmi_scaled_passing_score":t=t/100}}if(_errorCode=0,!_initialized)return SetError(132);if(_terminated)return SetError(133);if(contains(ReadOnlyElements,n.replace(/\./g,"_")))return SetError(404);if(n.search(/cmi_interactions_(\d+)_id/)>=0)RTE.cmi_interactions[n.match(/cmi_interactions_(\d+)_id/)[1]]=new interactions,RTE.cmi_interactions[n.match(/cmi_interactions_(\d+)_id/)[1]].id=t;else if(n.search(/cmi_interactions_(\d+)_(.+)/)>=0){i=n.match(/cmi_interactions_(\d+)_(.+)/);switch(i[2]){case"timestamp":RTE.cmi_interactions[i[1]].timestamp=t;break;case"type":RTE.cmi_interactions[i[1]].type=t;break;case"weighting":RTE.cmi_interactions[i[1]].weighting=t;break;case"learner_response":RTE.cmi_interactions[i[1]].learner_response=t;break;case"result":RTE.cmi_interactions[i[1]].result=t;break;case"latency":RTE.cmi_interactions[i[1]].latency=t;break;case"description":RTE.cmi_interactions[i[1]].description=t;break;default:r=i[2].match(/(.*)_(\d+)_.*/);r[1]=="objectives"?(RTE.cmi_interactions[i[1]].objectives[r[2]]=new objectives,RTE.cmi_interactions[i[1]].objectives[r[2]].id=t):r[1]=="correct_responses"&&(RTE.cmi_interactions[i[1]].correct_responses[r[2]]=new correct_responses,RTE.cmi_interactions[i[1]].correct_responses[r[2]].pattern=t)}}return RTE[n.replace(/\./g,"_")]!=null&&(RTE[n.replace(/\./g,"_")]=t),(n.replace(/\./g,"_")=="cmi_progress_measure"||n.replace(/\./g,"_")=="cmi_completion_status")&&Commit(""),"true"}function Commit(n){if(n!="")return SetError(201);if(_dirty){_errorCode=0;var t=JSON.stringify(RTE),i=RTE.cmi_completion_status=="completed",r={token:storyView.Token,lastStoryModuleId:this._storyModuleId,progressData:t,isStarted:!0,isFinished:i};$.ajax({url:"/Story/API/SetModuleProgress",data:r,type:"POST",dataType:"json",cache:!1,success:function(n){n.Error===null&&(storyView.Progress.FinishedTimestamp=n.Data!==null?n.Data.FinishedTimestamp:null)},error:function(){}}).done(function(){});_dirty=!1}return"true"}function Terminate(n){return n!=""?SetError(201):_initialized?_terminated?SetError(113):(_terminated=!0,_initialized=!1,Commit(""),"true"):SetError(112)}function GetLastError(){return _errorCode}function GetErrorString(n){switch(n){case 104:return"Communication with LMS has been terminated by the course.  Your results will not be saved.  Please close the course and try again.";case 112:return"Communication with the LMS has not be initialized by the course, but the course is attempting to terminate.  Your results will not be saved.  Please close the course and try again.";case 132:return"Communication with the LMS has not been initialized.  Your results will not be saved.  Please close the course and try again.";default:return"An unknown communication failure with the LMS has occurred.  Your results may not be saved.  Please close the course and try again.  Error #: "+n}}function SetError(n){return _errorCode=n,"false"}function SetErrorBlankResponse(n){return _errorCode=n,""}function initonenoteModule(){$("body").on("click",".btn-download-onenote",function(n){n.preventDefault();var t=this.getAttribute("data-module-id");exportNotebook(t)})}function loadOneNoteText(){$(".OneNoteNotebookText").text(storyLocalizations.onenote.Notebook)}function exportNotebook(n){var i={},t;i.token=$("#token").val();i.moduleIdentifier=n;showOneNoteProgressBar(n,storyLocalizations.onenote.CreatingMessage);t=$("#btn-download-onenote-"+n).text();$("#btn-download-onenote-"+n).text("Please Wait ...");$("#btn-download-onenote-"+n).attr("disabled","disabled");$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"/API/OneNote/ExportAsync",data:i,dataType:"Json",success:function(i){i!==null&&i.Error!==null?($("#btn-download-onenote-"+n).text(t),$("#btn-download-onenote-"+n).removeAttr("disabled"),hideOneNoteProgressBar(n),bootbox.alert("OneNote: "+i.Error)):(operationId=i.Data,checkLoadedOneNoteAsync().then(function(i){doneLoadingOneNote(i,n,t)}))},error:function(){bootbox.alert("OneNote: Error on export of note book");hideOneNoteProgressBar(n);$("#btn-download-onenote-"+n).text(t);$("#btn-download-onenote-"+n).removeAttr("disabled")}})}function doneLoadingOneNote(n,t,i){var r=n.Data.status,u;r==="running"&&(u='<div style="background-color: red; width: '+n.Data.percentComplete+'%; height: 22px;">'+n.Data.percentComplete+"%<\/div>",$("#onenote-progress-bar-"+t).html(u),checkLoadedOneNoteAsync().then(function(n){doneLoadingOneNote(n,t,i)}));r==="completed"?(hideOneNoteProgressBar(t),bootbox.confirm({title:storyLocalizations.onenote.LinkTitle,message:"<div>"+storyLocalizations.onenote.LinkMessage+"<\/div>",buttons:{confirm:{label:storyLocalizations.onenote.ConfirmButton,className:"btn-primary"},cancel:{label:storyLocalizations.onenote.CancelButton,className:"pull-right btn-link"}},callback:function(t){t&&window.open(n.Data.oneNoteWebUrl)}}),$("#btn-download-onenote-"+t).text(i),$("#btn-download-onenote-"+t).removeAttr("disabled")):r==="failed"&&(hideOneNoteProgressBar(t),bootbox.alert("OneNote: "+n.Data.error),$("#btn-download-onenote-"+t).text(i),$("#btn-download-onenote-"+t).removeAttr("disabled"))}function checkLoadedOneNoteAsync(){var n={};return n.operationId=operationId,$.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:"/API/OneNote/OperationStatus",data:n,dataType:"Json",success:function(n){n!==null&&n.Error!==null&&bootbox.alert("OneNote: "+n.Error)},error:function(){bootbox.alert("OneNote: Error on export of note book.")}})}function showOneNoteNoticeLoader(n,t){var i='<div id="onenote-notice-spinner"><div class="row">'+t+'<\/div><div class="story-loader row" ><img src="/Assets/images/ajax-loader.gif" /><\/div><\/div>';$("#onenote-notice-spinner").length===0&&$(i).insertAfter("#btn-download-onenote-"+n)}function hideOneNoteNoticeLoader(){$("#onenote-notice-spinner").remove()}function showOneNoteProgressBar(n){var t='<div id="onenote-progress-bar-'+n+'" class="row progress-bar" style="background-color: white; width: 150px; height: 25px; padding: 2px;"><div style="background-color: red; width: 10%; height: 22px;">0%<\/div><\/div>';$("#onenote-progress-bar-"+n).length===0&&$(t).insertAfter("#hold-download-onenote-"+n)}function hideOneNoteProgressBar(n){$("#onenote-progress-bar-"+n).remove()}var textModule,scheduleTimes,userHasAcknowledged3DayWindow,operationId;commonGetTopLevelCategories;CONTENTPACKAGECATEGORYID=null;CONTENTPACKAGESUBCATEGORYID=null;$(function(){initHeaderModuleTemplates();initHeaderModuleEvents()});$(window).resize(function(){throttle(toggleCarouselSlides(),50)});textModule=textModule||{};textModule.display=function(){function n(){t()}function t(){var n;$(document.body).on("click",".story-text-pillar .btn",function(){var i=$(this),t=i.attr("href"),r;return(n=n||$("#textPillarYoutubeModal"),t.charAt(0)==="#")?(r=$(String.format(".module[data-module-id={0}]",t.replace("#",""))),$(document.body).animate({scrollTop:$(r).offset().top},1e3),!1):n.length>0&&i.prop("target").length===0&&t.indexOf("youtube")>-1?(n.modal("show"),n.find("button").prop("disabled",!1),n.find("iframe").attr("src",t.replace("/watch?v=","/embed/")),!1):void 0})}return{init:n}}();$(function(){textModule.display.init()});CONTENTPACKAGECATEGORYID=null;CONTENTPACKAGESUBCATEGORYID=null;var startRecorded=!1,endRecorded=!1,currentPlayer="";$(document).ready(function(){var n=0,t=setInterval(function(){$(".twitter-widgets").length&&(window.twttr=function(n,t,i){var u,r,f=n.getElementsByTagName(t)[0];if(!n.getElementById(i))return r=n.createElement(t),r.id=i,r.src="https://platform.twitter.com/widgets.js",f.parentNode.insertBefore(r,f),window.twttr||(u={_e:[],ready:function(n){u._e.push(n)}})}(document,"script","twitter-wjs"),twttr.widgets.load(),clearInterval(t));n++;n===15&&clearInterval(t)},1500)});userHasAcknowledged3DayWindow=!1;$(document).ready(function(){var n=$("#scheduleModal");$(document).on("OnStoryRenderComplete",function(){bindInteractionRequestSummary()});$(document).on("click",".saveschedule",function(n){var t,i;if(n.preventDefault(),t=$("#schedule-time-modal input:checked").val(),t===""||t===null||t===undefined)return bootbox.alert("Please select a time",function(){$(".modal").on("hidden.bs.modal",function(){isABootstrapModalOpen()&&$("body").addClass("modal-open")})}),!1;i={storyToken:story.Token,requestedDateUTC:t,overridecheck:userHasAcknowledged3DayWindow,skip:!1,message:$("#interaction-message").val()};registerForSession("RequestSession",i)});$(document).on("click",".send-message",function(n){if(n.preventDefault(),$("#interaction-message").val().length==0){$("#interaction-message-required").removeClass("hide");return}$("#interaction-message-required").addClass("hide");var t={storyToken:story.Token,overridecheck:userHasAcknowledged3DayWindow,skip:!1,message:$("#interaction-message").val()};registerForSession("RequestSession",t)});$(document).on("click",".btn-skip-and-send",function(){var n=$(this).attr("data-time"),t={storyToken:story.Token,requestedDateUTC:n,overridecheck:userHasAcknowledged3DayWindow,skip:!0,message:$("#interaction-message").val(),forgotSkypeId:$("#interaction-forgot-skype").prop("checked")};registerForSession("RequestSession",t)});$(document).on("click",".btn-update-and-send",function(){var n=$(".btn-skip-and-send").attr("data-time"),t={storyToken:story.Token,requestedDateUTC:n,overridecheck:userHasAcknowledged3DayWindow,skip:!1,message:$("#interaction-message").val(),profileFields:{SkypeID:$("#interaction-skype-id").val(),SchoolName:$("#interaction-school-name").val(),AgeGroup:$("input[name='interaction-profile-age']:checked").map(function(){return this.value}).toArray(),Subjects:$("input[name='interaction-profile-subject']:checked").map(function(){return this.value}).toArray(),IForgotMySkypeID:$("#interaction-forgot-skype").prop("checked")}};registerForSession("UpdateProfile",t)});$(".scheduleNewTime").on("click",proposeNewTimeClick)});$(function(){initSetFilterFromOpenHTML()});var _initialized=!1,_terminated=!1,_errorCode=0,_dirty=!1,_version="1.0",_storyModuleId,RTE=new RTE2004,api=this,API=this,API_1484_11=this,CurrentVersion="2004";this.ReadOnlyElements=[];this.ReadOnlyElements.push("cmi__version");this.ReadOnlyElements.push("cmi_learner_id");this.ReadOnlyElements.push("cmi_learner_name");this.ReadOnlyElements.push("cmi_credit");this.ReadOnlyElements.push("cmi_entry");this.ReadOnlyElements.push("cmi_completion_threshold");$(document).on("OnStoryRenderComplete",function(){$(".NotifyOnClick").on("click",function(){var n=$(this).attr("data-moduleidentifier"),t=$(this).attr("data-resourceidentifier"),i={token:story.Token,moduleIdentifier:n,resourceIdentifier:t};$.ajax({url:"/Story/API/LinkClicked",type:"POST",data:i,async:!0,cache:!1,success:function(n){n.Error!==null&&bootbox.alert(n.Error)},error:function(n,t,i){bootbox.alert(i)}})})});$(function(){initonenoteModule()});operationId="";
//# sourceMappingURL=display-modules.min.js.map